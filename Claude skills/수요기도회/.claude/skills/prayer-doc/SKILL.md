---
name: prayer-doc
description: >
  디딤교회 수요기도회 기도제목 A4 문서를 자동 생성하는 스킬.
  CSV 파일에서 특정 월/주차의 기도제목을 추출하고 교회 로고가 포함된
  A4 HTML 문서를 생성한 뒤 PNG로 캡처한다.
  "기도제목", "수요기도회", "기도제목 문서", "○월 ○주차 기도제목" 등을
  언급하면 이 스킬을 자동으로 사용하라.
allowed-tools:
  - Bash
  - Read
  - Write
---

# 디딤수요기도회 기도제목 자동 생성

## 실행 절차

### 1단계: 사용자 입력 확인

사용자에게 **월**과 **주차**를 확인한다.

한국어 서수 변환:
- 첫째/첫번째/1주 → 1주차
- 둘째/두번째/2주 → 2주차
- 셋째/세번째/3주 → 3주차
- 넷째/네번째/4주 → 4주차
- 다섯째/다섯번째/5주 → 5주차

주차를 지정하지 않으면 반드시 확인 요청한다.

### 2단계: CSV 데이터 확인

`data/` 폴더에서 CSV 파일을 찾는다:
```bash
ls data/*.csv
```
CSV가 없으면 사용자에게 구글 시트에서 CSV로 내보내어 `data/` 폴더에 넣도록 안내한다.

### 3단계: 파이프라인 실행

통합 스크립트로 한 번에 실행:
```bash
python3 .claude/skills/prayer-doc/scripts/run_pipeline.py \
  data/<csv파일명> <월> <주차> \
  --base-dir .
```

이 스크립트가 자동으로:
1. CSV에서 해당 월/주차 기도제목 추출
2. `assets/logo.png`를 포함한 A4 HTML 생성
3. wkhtmltoimage로 PNG 캡처
4. `output/{월}월/{주차}주차/` 에 저장

### 4단계: 결과 안내

생성된 파일 경로를 사용자에게 안내한다:
```
output/{월}월/{주차}주차/기도제목_{월}월_{주차}주차.html
output/{월}월/{주차}주차/기도제목_{월}월_{주차}주차.png
```

## CSV 데이터 구조

| 열 | 내용 |
|----|------|
| A(0) | 월 ("1월"~"12월") |
| B(1) | 분기 주제 |
| C(2) | 수요예배 제목 |
| D(3) | 본문 (성경구절) |
| E(4)~F(5) | 1주차 (공동체/개인) |
| G(6)~H(7) | 2주차 (공동체/개인) |
| I(8)~J(9) | 3주차 (공동체/개인) |
| K(10)~L(11) | 4주차 (공동체/개인) |
| M(12)~N(13) | 5주차 (공동체/개인) |

## 에러 처리

| 상황 | 대응 |
|------|------|
| CSV 없음 | "data/ 폴더에 CSV 파일이 없습니다. 구글 시트에서 다운로드해 주세요." |
| 해당 월 없음 | "○월 데이터를 찾을 수 없습니다." |
| 해당 주차 비어있음 | "○월 ○주차 기도제목이 비어있습니다." |
| wkhtmltoimage 미설치 | HTML만 제공하고 설치 방법 안내 |
